# 週表示修正完了報告 - 2025年1月28日

## 修正内容

### 1. 稼働者状況ダッシュボードの4列構成修正
- **問題**: 3列しか表示されていない（4列目が欠けている）
- **原因**: 重複除外ロジックが過度に働いて必要な列まで削除していた
- **修正**: 
  - `shouldExcludeWeek`関数を緩和し、4列構成を確実に保つように修正
  - フロントエンドで4列構成を強制的に生成するロジックを実装
  - 共通の週計算ロジック`generateFourWeekRange`を使用

### 2. 採用活動ダッシュボードの週表示順序修正
- **問題**: 選択週が4列目に来ている（仕様では3列目が正しい）
- **原因**: 週生成ロジックが過去4週間を生成していた
- **修正**:
  - 週生成ロジックを「前々週、前週、選択週、翌週」の4列構成に変更
  - 共通の週計算ロジック`generateFourWeekRange`を使用して統一

### 3. 共通ロジックの統一
- **実装**: `lib/date.ts`に`generateFourWeekRange`関数を追加
- **機能**: 4週間のデータを生成（前々週、前週、選択週、翌週）
- **統一**: 稼働者状況と採用活動で同じ週計算ロジックを使用

## 修正ファイル
1. `app/api/work-status/weekly-detail/route.ts` - 重複除外ロジック修正
2. `components/work-status/detailed-status-table.tsx` - 4列構成実装
3. `components/recruitment-collection-table.tsx` - 週表示順序修正
4. `components/recruitment-interview-table.tsx` - 週表示順序修正
5. `components/rejection-reason-table.tsx` - 週表示順序修正
6. `lib/date.ts` - 共通週計算ロジック追加

## 期待される結果
- 稼働者状況ダッシュボード: 4列構成で正しく表示
- 採用活動ダッシュボード: 選択週が3列目に正しく表示
- 月またぎの週: 「7月5W/8月1W」として統一表示
- 数値の不整合: APIとフロントエンドで一致

## 次のステップ
1. 開発サーバーでの動作確認
2. 実際のデータでの表示確認
3. 必要に応じてデバッグログの調整
4. 数値の不整合問題の解決（必要に応じて）