# SOW: UI非反映問題の根本原因調査と解決 (Phase 5)

## 1. 背景と目的
APIによるデータ更新処理は成功しているように見えるが、最終的なUI（レポートの表）にその結果が反映されない、というクリティカルな問題が発生している。この問題の根本原因を、データフローの各段階（API応答、データ取得フック、UIコンポーネントの状態管理）にわたって多角的に調査・特定し、完全に解決することを目的とする。

## 2. 作業範囲 (Scope of Work)

### フェーズ1: データの流れの徹底的な可視化

以下の各ポイントに、**コンソールログ出力によるデバッグコード**を仕込み、データの流れを追跡可能にする。

*   **タスク1.1: APIの出口を検証する**
    *   **対象ファイル:** `app/api/recruitment/sync-week/route.ts`
    *   **修正内容:** `return NextResponse.json(...)` の直前で、フロントエンドに返却する `updatedReports` の内容を `console.log` で出力する。これにより、APIが正しい形式と内容のデータを返しているかを確証する。

*   **タスク1.2: フックの入口を検証する**
    *   **対象ファイル:** `hooks/use-weekly-reports.ts`
    *   **修正内容:** `fetcher` 関数（またはそれに準ずるデータ取得ロジック）がAPIからレスポンスを受け取った直後に、その内容を `console.log` で出力する。これにより、フックがAPIから新しいデータを正しく受け取れているかを確認する。

*   **タスク1.3: UIコンポーネントへの伝達を検証する**
    *   **対象ファイル:** `components/recruitment-dashboard.tsx`
    *   **修正内容:** `useEffect` を使用し、`weeklyData` が変更されるたびに、その新しい内容を `console.log` で出力する。これにより、フックから返された新しいデータが、コンポーネントの状態として正しくセットされているかを確認する。

### フェーズ2: 原因の特定と修正

*   **タスク2.1:** フェーズ1で取得した一連のコンソールログを分析し、以下のいずれの段階で問題が発生しているかを特定する。
    1.  APIが正しいデータを返していない。
    2.  フックが新しいデータを受け取れていない（キャッシュの問題など）。
    3.  フックからデータは渡されているが、UIコンポーネントのstateが更新されていない。
*   **タスク2.2:** 特定した根本原因に基づき、関連するファイル（API、フック、またはコンポーネント）に的確な修正を行う。

## 3. 成果物
1.  データの流れを詳細に示すコンソールログ。
2.  特定された根本原因の報告。
3.  問題が完全に解決され、UIが正しく更新される「選択週の同期」機能。

## 4. 開発上の絶対的ルール
- 本件の開発は、`docs/GEMINI_RULES.md` に記載されたルールに厳密に従うものとする。
