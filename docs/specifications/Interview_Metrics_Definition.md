# 面接（選抜フェーズ）指標の定義

## 概要
面接（選抜フェーズ）指標は、採用活動における面接段階の進捗と成果を測定する指標群です。

## 指標一覧

### 1. 面接予定数（interviewScheduled）
- **定義**: 対象週に面接が予定された件数
- **判定方法**: 採用管理シートの「面談予定日時」列（G列系）が対象週内に含まれる行をカウント
- **データソース**: 採用管理シート
- **列名**: 面談予定日時、面接予定日、面接日

### 2. 面接実施数（interviewConducted）
- **定義**: 対象週に面接が実際に実施された件数
- **判定方法**: 採用管理シートの「面談実施日」列（H列系）が対象週内に含まれる行をカウント
- **データソース**: 採用管理シート
- **列名**: 面談実施日、面接実施日、面談完了日、面接完了日

### 3. 面接辞退数（interviewCancelled）
- **定義**: 対象週に面接予定だったが辞退された件数
- **判定方法**: 面談予定日時が対象週内 かつ 採用管理シートの「現状ステータス」列が「面接不参加」または「面談不参加」
- **データソース**: 採用管理シート
- **条件**: 面談予定日時（G列）が対象週内 AND ステータスが「面接不参加」または「面談不参加」

### 4. 採用者数（hireCount）
- **定義**: 対象週に採用が決定された件数
- **判定方法**: 面談実施日が対象週内 かつ 採用管理シートの「現状ステータス」列が「採用」
- **データソース**: 採用管理シート
- **条件**: 面談実施日（H列）が対象週内 AND ステータスが「採用」

### 5. 内定受諾数（offerAcceptedCount）
- **定義**: 対象週に内定を受諾した件数
- **判定方法**: 採用管理シートの「内定受諾日」列（I列）が対象週内のものをカウント
- **データソース**: 採用管理シート
- **列名**: 内定受諾日、承諾日、内定承諾日

## 計算指標

### 6. 面接実施率（interviewRate）
- **定義**: 面接予定数に対する面接実施数の割合
- **計算式**: `(面接実施数 / 面接予定数) × 100`
- **表示**: 小数点第1位まで（例：85.7%）
- **特殊ケース**: 分母が0の場合は0%と表示
- **重要**: 同一週内の面接予定者と面接実施者で計算

### 7. 内定受諾率（acceptanceRate）
- **定義**: 採用者数に対する内定受諾数の割合
- **計算式**: `(内定受諾数 / 採用者数) × 100`
- **表示**: 小数点第1位まで（例：90.0%）
- **特殊ケース**: 分母が0の場合は0%と表示
- **重要**: 同一週内の採用者と内定受諾者で計算

## 重要な特徴

### A. 日付判定の基準
- **面接予定**: 面談予定日時（G列）で週判定
- **面接実施**: 面談実施日（H列）で週判定
- **採用**: 面談実施日（H列）で週判定
- **内定受諾**: 内定受諾日（I列）で週判定

### B. 応募日との関係
- 面接系指標は**応募日で絞らない**
- 面談予定日時や面談実施日が対象週内であれば集計対象

### C. 率の計算の正規化
- 面接実施率と内定受諾率は、**同一週内の同一対象者グループ**で計算
- 異なる週のデータを混在させて計算することはない
- これにより、正確な変換率を測定可能

### D. データの整合性
- 各指標は独立して計算される
- 率の計算時のみ、同一週内の関連指標を使用
- 分母が0の場合は適切に0%と表示

## 実装上の注意点

1. **内定受諾数の修正**: 以前は面談実施日（H列）で判定していたが、正しくは内定受諾日（I列）で判定する
2. **率の計算**: 同一週内のデータのみを使用して計算する
3. **列名のエイリアス**: 複数の列名に対応（面談予定日時、面接予定日など）
4. **ステータスの正規化**: ステータス名のバリエーションに対応

## 関連ファイル
- `gas/recruitment-complete.gs`: メインの計算ロジック
- `gas/sheet.gs`: シート別の計算ロジック
- `lib/constants/recruitment-metrics-definitions.ts`: 指標定義
- `components/recruitment-interview-table.tsx`: UI表示ロジック
